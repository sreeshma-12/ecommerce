<%-include('../users/layouts/header.ejs') -%>
<div class="page-holder">
  <div class="container">
    <HERO SECTION-->
     <section class="py-5 bg-light">
      <div class="container">
        <div class="row px-4 px-lg-5 py-lg-4 align-items-center">
          <div class="col-lg-6">
            <h1 class="h2 text-uppercase mb-0">Order history</h1>
          </div>
          <div class="col-lg-6 text-lg-end">
            <nav aria-label="breadcrumb">
              <ol class="breadcrumb justify-content-lg-end mb-0 px-0 bg-light">
                <li class="breadcrumb-item"><a class="text-dark" href="/">Home</a></li>
                <li class="breadcrumb-item active" aria-current="page">Order history</li>
              </ol>
            </nav>
          </div>
        </div>
      </div>
    </section> 
     <!-- <% orderDetails.forEach((order,i)=> { %> 
      <%= order.bill_amount  %>
       <% }); %> 
              -->
     <div class="page-content">
      <div class="widget-content widget-content-area add-manage-product-2 container mt-3">
        <div class="row ">
          <div class="col-md-2 ">
            <div class="card card-default " style="border-color: white !important; color: black !important;">
              <div class="card border-0 ad-box-shadow p-0 ">
                <div class="card-body col-sm-112">
                  <div id="dragged_images">
                  </div>
                  <div class=" d-flex justify-content-center mt-4">
                    <div class=" ">
                     <a class="btn btn-sm btn-block d-flex align-items-center justify-content-center text-light " href="/account" style="background-color: rgb(63, 63, 63)">Account</a>
                      <a class="btn btn-sm btn-block  d-flex align-items-center justify-content-center px-0 text-light mt-3" href="/orderDetails" style="background-color: rgb(63, 63, 63)">Order Details</a>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div> 
           <div class=" col-md-10 ">
            <div class="admincard card card-default" style="border-color: white !important;">
              <div class="card-body ">
                <div class="card-body ">
                   
                  <h3 class="text-dark text-center">No Orders</h3>
                  <div class="d-flex justify-content-center flex-coloumn">
                    <a href="/shop" class="btn btn-success">Go to Shop</a>
                  </div> 
                  
                   <div class="table-responsive mb-4 border border-2 border-black">
                    <table class="table text-nowrap">
                      <thead class="bg-light">
                        <tr> 
                         <th class="border-0 p-3 ps-3" scope="col"> <strong class="text-sm text-uppercase">Ordered Date</strong></th>
                          <!-- <th class="border-0 p-3" scope="col"> <strong class="text-sm text-uppercase">Address</strong></th> -->
                          <th class="border-0 p-3" scope="col"> <strong class="text-sm text-uppercase">Total price</strong></th>
                          <th class="border-0 p-3" scope="col"> <strong class="text-sm text-uppercase">Payment method</strong></th>
                          <th>   </th>
                      <th class="border-0 p-3 text-center" scope="col"> <strong class="text-sm text-uppercase">status</strong></th>
        
                       <th class="border-0 p-3 text-center" scope="col"> <strong class="text-sm text-uppercase">View detials</strong></th>
                        </tr>
                      </thead>
                      <tbody class="border-0">
                        <% orderDetails.forEach((order,i)=> { %> 
                        <tr>
                          <th class="ps-0 py-3 border-light ps-3" scope="row">
                            <div class="d-flex align-items-center ">
                          <%= order.ordered_date.getDate() %>/<%= order.ordered_date.getMonth()+1 %>/<%= order.ordered_date.getFullYear() %> 
                              </div>
                      <!-- <td>
                        <%= order.address %>     
                            </td> -->
                            <td>
                              <%= order.bill_amount %>   
                            </td>
                            <td>
                           <%= order.payment.payment_method %>
                             </td>
                       </th> 
                            <!-- <th class="ps-0 py-3 border-light align-middle" scope="row">
                            <div class="ms-3"><br></div>
                          </th> -->
                          <!-- <td class="p-3 align-middle border-light">
                           <span class="text-success"></span>
                             <span class="text-danger"></span>
                           </td> -->
                       <!-- <td class="p-3 align-middle border-light">
                            <p class="mb-0 small"></p>
                          </td>  -->
                        
                          <td class="p-3 align-middle border-light ps-5">
                             
    <% if(order.payment.payment_status=='pending'){ %> 
    <%= order.payment.payment_method %>-<span class="badge border border-warning  text-warning px-2 py-1 rounded-3 fw-bold"><%= order.payment.payment_status %></span> 
        <% }else{ %> 
    <%= order.payment.payment_method %>-<span class="badge border border-success  text-success px-2 py-1 rounded-3 fw-bold"><%= order.payment.payment_status %></span> 
    <% } %> 
 
                          </td>
                          </td>
                          <td class="p-4 text-center border-light">
                            <a href=""><i class="bi bi-eye text-black"></i></a>
                          </td>
                        </tr>
                       <!-- <td> -->
                     <a href="/users/orderinvoice/<%= order._id %>"><i class="bi bi-receipt text-light"></i></a>        
                      <!-- </td>   -->
                        <% }); %> 
                       </tbody> 
                    </table> 
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
       </div>
      </div>
   </div>
 </div>  
<div class="container p-5 ">
  <table id="myTable" class="table table-striped table-bordered table-responsive table-hover" >
    <thead>
      <tr>
        <th scope="col">#</th>
        <th scope="col">OrderID</th>
        <!--<th scope="col">User</th>-->
        <th scope="col">Items</th>
        <th scope="col">Ordered</th>
        <th scope="col">od status</th>
        <th scope="col">payment status</th>
        <!-- <th scope="col">Actions</th> -->
      </tr>
     </thead>
  <tbody>
  <% orderDetails.forEach((order,i)=> { %> 
 <tr>
 <td>
    <%= i+1 %> 
 </td> 
 <td>
  <%= order._id %> 
 </td> 
  <!-- <td>
    <%= order.userid.userName %> 
 </td>  -->
 <td>
  <%= order.products.length %> 
 </td>
 <td>
  <%= order.ordered_date.getDate() %>/<%= order.ordered_date.getMonth()+1 %>/<%= order.ordered_date.getFullYear() %> 
 </td>
 <td class="text-light">
    <% if(order.delivery_status.returned.state){ %> 
    <p><b class="text-warning">RETURNED</b><small>(<%= order.delivery_status.returned.date.getDate() %>/<%= order.delivery_status.returned.date.getMonth()+1 %>/<%= order.delivery_status.returned.date.getFullYear() %>)</small> </p>
    <% }else if(order.delivery_status.delivered.state){ %> 
    <p><b class="text-success">DELIVERED</b><small>(<%= order.delivery_status.delivered.date.getDate() %>/<%= order.delivery_status.delivered.date.getMonth()+1 %>/<%= order.delivery_status.delivered.date.getFullYear() %>)</small> </p> 
    <% }else if(order.delivery_status.canceled.state){  %> 
    <p> <b class="text-danger">CANCELED</b><small>(<%= order.delivery_status.canceled.date.getDate() %>/<%= order.delivery_status.canceled.date.getMonth()+1 %>/<%= order.delivery_status.canceled.date.getFullYear() %>)</small> </p> 
    <% }else if(order.delivery_status.out_for_delivery.state){ %> 
    <p> <b>OUT_FOR_DELIVERY</b><small>(<%= order.delivery_status.out_for_delivery.date.getDate() %>/<%= order.delivery_status.out_for_delivery.date.getMonth()+1 %>/<%= order.delivery_status.out_for_delivery.date.getFullYear() %>)</small> </p> 
    <% }else if(order.delivery_status.shipped.state){  %> 
    <p> <b class="text-info">SHIPPED</b><small>(<%= order.delivery_status.shipped.date.getDate() %>/<%= order.delivery_status.shipped.date.getMonth()+1 %>/<%= order.delivery_status.shipped.date.getFullYear() %>)</small> </p> 
    <% }else if(order.delivery_status.ordered.state){  %> 
    <p> <b>ORDERED</b><small>(<%= order.delivery_status.ordered.date.getDate() %>/<%= order.delivery_status.ordered.date.getMonth()+1 %>/<%= order.delivery_status.ordered.date.getFullYear() %>)</small> </p> 
    <% } %> 
 </td>
  <td>
    <% if(order.payment.payment_status=='pending'){ %> 
    <%= order.payment.payment_method %>-<span class="badge border border-warning  text-warning px-2 py-1 rounded-3 fw-bold"><%= order.payment.payment_status %></span> 
    <% }else{ %> 
    <%= order.payment.payment_method %>-<span class="badge border border-success  text-success px-2 py-1 rounded-3 fw-bold"><%= order.payment.payment_status %></span> 
    <% } %> 
 </td> 
 <!-- <td>
   <a class="mx-3" href="/orderlist/<%= order._id %>"><i class="bi bi-eye-fill text-light"></i></a>
   <a href="/orderinvoice/<%= order._id %>"><i class="bi bi-receipt text-light"></i></a>
 </td> -->
 <td>
</td>
</tr>
<% }); %> 
</tbody>
</table> 
</div>
<!-- ----------------------------------------->
<!-- your other HTML code for the user page -->
<%-include('../layouts/footer.ejs')%> 